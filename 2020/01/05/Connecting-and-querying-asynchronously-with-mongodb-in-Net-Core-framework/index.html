<!DOCTYPE html>
<html lang="en">

<!-- Head tag -->
<head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!--Description-->
    
        <meta name="description" content="How to connect and query Mongodb database in .Net core framework, asynchronous way.If you have a Mongodb collection want to query using .Net Core, the">
    

    <!--Author-->
    
        <meta name="author" content="John Doe">
    

    <!--Open Graph Title-->
    
        <meta property="og:title" content="Connecting and querying asynchronously with mongodb in .Net Core framework"/>
    

    <!--Open Graph Description-->
    

    <!--Open Graph Site Name-->
    <meta property="og:site_name" content="Hexo"/>

    <!--Type page-->
    
        <meta property="og:type" content="article" />
    

    <!--Page Cover-->
    

    <meta name="twitter:card" content="summary" />
    

    <!-- Title -->
    
    <title>Connecting and querying asynchronously with mongodb in .Net Core framework - Hexo</title>

    <!-- Tachyons Core CSS -->
    <link rel="stylesheet" href="https://unpkg.com/tachyons/css/tachyons.min.css">

    <!-- Custom Fonts -->
    <link href="//maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet" type="text/css">

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
        <script src="//oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="//oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->

    <!-- Custom CSS -->
    
<link rel="stylesheet" href="/css/style.css">


    <!-- Google Analytics -->
    


<meta name="generator" content="Hexo 4.1.1"></head>


<body>

<!-- Main Content -->
<!-- Banner -->
<!-- Banner -->
<div class="w-100 bg-1 ph5-ns ph3 text-light">
    
    <nav class="db dt-l w-100 mw8 center border-box pv3">
        <a class="db dtc-l v-mid link dim w-100 w-25-l tc tl-l mb2 mb0-l white" href="/" title="Hexo">
            <img src="http://www.codeblocq.com/assets/projects/hexo-theme-anodyne/assets/anodyne.svg" class="dib h3" alt="Hexo">
        </a>
        <div class="db dtc-l v-mid w-100 w-75-l tc tr-l">
            
                <a class="link dim f6 f5-l dib mr3 mr4-l white" 
                    href="/" 
                    title="Home">
                    Home
                </a>
            
                <a class="link dim f6 f5-l dib mr3 mr4-l white" 
                    href="/archives" 
                    title="Archives">
                    Archives
                </a>
            
                <a class="link dim f6 f5-l dib mr3 mr4-l white" 
                    href="/tags" 
                    title="Tags">
                    Tags
                </a>
            
                <a class="link dim f6 f5-l dib mr3 mr4-l white" 
                    href="/categories" 
                    title="Categories">
                    Categories
                </a>
            
                <a class="link dim f6 f5-l dib mr3 mr4-l white" 
                    href="/about.html" 
                    title="About">
                    About
                </a>
            
                <a class="link dim f6 f5-l dib mr3 mr4-l white" 
                    href="/contact.html" 
                    title="Contact">
                    Contact
                </a>
            
        </div>
    </nav>

    <!-- Title -->
    <div class="w-100 mw8 center vh-40 dt">
        <div class="dtc v-mid white">
            <h1 class="f1-l f2-m tc tc-m tl-ns">Connecting and querying asynchronously with mongodb in .Net Core framework</h1>
            <p class="f4 fw3 pab-100px tc tc-m tl-ns">2020-01-05</p>
        </div>
    </div>

    <!-- Icon -->
    <div class="relative w-100 mw8 center white dn dn-m db-ns">
        <i class="header-icon fa fa-file-text-o"></i>
    </div>
</div>

<!-- Content -->
<div class="w-100 ph2 ph4-m ph5-l mv5 mv6-l">
    <div class="content">
        <div class="mw8 center">
            <div class="cf">
                <div class="fl w-100 w-70-l mw7 left fw3 lh-copy pr4-ns pr0-m post-content">
                    <!-- Tags Vertical -->
                    
                        <div class="tags-container-vertical">
                            <div class="tags-sub-container">
                                <a class="fw3 ph1 dib" href="/tags/Mongodb/">#Mongodb</a> <a class="fw3 ph1 dib" href="/tags/Net-Core/">#.Net Core</a>
                            </div>
                        </div>
                    

                    <!-- Main Post Content -->
                    <h1 id="How-to-connect-and-query-Mongodb-database-in-Net-core-framework-asynchronous-way"><a href="#How-to-connect-and-query-Mongodb-database-in-Net-core-framework-asynchronous-way" class="headerlink" title="How to connect and query Mongodb database in .Net core framework, asynchronous way."></a>How to connect and query Mongodb database in .Net core framework, asynchronous way.</h1><h2 id="If-you-have-a-Mongodb-collection-want-to-query-using-Net-Core-there-are-few-steps-you-could-follow"><a href="#If-you-have-a-Mongodb-collection-want-to-query-using-Net-Core-there-are-few-steps-you-could-follow" class="headerlink" title="If you have a Mongodb collection want to query using .Net Core, there are few steps you could follow."></a>If you have a Mongodb collection want to query using .Net Core, there are few steps you could follow.</h2><h3 id="Firstly-you-should-have-an-collection-ready-on-you-Mongodb-database-and-get-Mongodb-driver-installed-using-Nuget-of-course"><a href="#Firstly-you-should-have-an-collection-ready-on-you-Mongodb-database-and-get-Mongodb-driver-installed-using-Nuget-of-course" class="headerlink" title="Firstly, you should have an collection ready on you Mongodb database and get Mongodb driver installed using Nuget.(of course)"></a>Firstly, you should have an collection ready on you Mongodb database and get Mongodb driver installed using Nuget.(of course)</h3><h3 id="Then-you-can-follow-the-steps-to-get-your-database-connected"><a href="#Then-you-can-follow-the-steps-to-get-your-database-connected" class="headerlink" title="Then, you can follow the steps to get your database connected :)"></a>Then, you can follow the steps to get your database connected :)</h3><h3 id="1-Putting-your-ConnectionString-and-database-name-into-your-appettings-json-file"><a href="#1-Putting-your-ConnectionString-and-database-name-into-your-appettings-json-file" class="headerlink" title="1. Putting your ConnectionString and database name into your appettings.json file."></a>1. Putting your ConnectionString and database name into your appettings.json file.</h3><blockquote>
<p>Adding one entry to field for your mongoDb Connection.</p>
<blockquote>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">"MongoConnection": &#123;</span><br><span class="line">   "ConnectionString": "mongodb://your_host_ip_address:27017/",</span><br><span class="line">   "Database": "your_database_name"</span><br><span class="line"> &#125;,</span><br></pre></td></tr></table></figure>
</blockquote>
</blockquote>
<h3 id="2-It’s-time-to-implement-classes"><a href="#2-It’s-time-to-implement-classes" class="headerlink" title="2. It’s time to implement classes"></a>2. It’s time to implement classes</h3><blockquote>
<h4 id="Create-Setting-class-to-store-your-connection-string-and-database-name-we-call-this-file-Settings-cs"><a href="#Create-Setting-class-to-store-your-connection-string-and-database-name-we-call-this-file-Settings-cs" class="headerlink" title="Create Setting class to store your connection string and database name, we call this file Settings.cs"></a>Create Setting class to store your connection string and database name, we call this file Settings.cs</h4><blockquote>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">Settings</span></span><br><span class="line"> &#123;</span><br><span class="line">       <span class="keyword">public</span> <span class="keyword">string</span> ConnectionString;</span><br><span class="line">       <span class="keyword">public</span> <span class="keyword">string</span> Database;</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure>
</blockquote>
<h4 id="Under-same-file-create-another-context-class-called-MongoContext"><a href="#Under-same-file-create-another-context-class-called-MongoContext" class="headerlink" title="Under same file, create another context class called MongoContext"></a>Under same file, create another context class called MongoContext</h4><blockquote>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">MongoContext</span></span><br><span class="line">&#123;</span><br><span class="line">   <span class="keyword">private</span> <span class="keyword">readonly</span> IMongoDatabase _database = <span class="literal">null</span>;</span><br><span class="line"></span><br><span class="line">   <span class="function"><span class="keyword">public</span> <span class="title">MongoContext</span>(<span class="params">IOptions&lt;Settings&gt; settings</span>)</span></span><br><span class="line"><span class="function"></span>   &#123;</span><br><span class="line">       <span class="keyword">var</span> client = <span class="keyword">new</span> MongoClient(settings.Value.ConnectionString);</span><br><span class="line"></span><br><span class="line">       <span class="keyword">if</span> (client != <span class="literal">null</span>)</span><br><span class="line">       &#123;</span><br><span class="line">           _database client.GetDatabase(settings.Value.Database);</span><br><span class="line">       &#125;</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">   <span class="keyword">public</span> IMongoCollection&lt;Restaurant&gt; Restaurants</span><br><span class="line">   &#123;</span><br><span class="line">       <span class="keyword">get</span> &#123; <span class="keyword">return</span> _database.GetCollection&lt;Restaurant&gt;(<span class="string">"your_collection_ne"</span>); &#125;</span><br><span class="line">   &#125;</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>
</blockquote>
</blockquote>
<h2 id="Now-you-have-finished-connection-settings-it’s-time-to-build-Repository-class-that-serves-as-agent-to-get-your-results-from-your-database"><a href="#Now-you-have-finished-connection-settings-it’s-time-to-build-Repository-class-that-serves-as-agent-to-get-your-results-from-your-database" class="headerlink" title="Now you have finished connection settings, it’s time to build Repository class that serves as agent to get your results from your database."></a>Now you have finished connection settings, it’s time to build Repository class that serves as agent to get your results from your database.</h2><h3 id="3-Create-a-class-to-map-your-fields-to-C-class"><a href="#3-Create-a-class-to-map-your-fields-to-C-class" class="headerlink" title="3. Create a class to map your fields to C# class"></a>3. Create a class to map your fields to C# class</h3><h3 id="Note-your-fields-in-c-class-should-exactly-map-the-fields-you-have-in-your-collection-For-example-if-each-entry-in-your-mongodb-collection-has-5-fields-including-Mongodb-id-you-must-create-5-fields-in-your-class-to-map-those-fields-Otherwise-it-won’t-work-as-you-expected-Each-field-can-be-annotated-with-BsonElement-to-tell-the-driver-this-is-the-field-in-the-class-to-map-the-field-in-the-Mongodb"><a href="#Note-your-fields-in-c-class-should-exactly-map-the-fields-you-have-in-your-collection-For-example-if-each-entry-in-your-mongodb-collection-has-5-fields-including-Mongodb-id-you-must-create-5-fields-in-your-class-to-map-those-fields-Otherwise-it-won’t-work-as-you-expected-Each-field-can-be-annotated-with-BsonElement-to-tell-the-driver-this-is-the-field-in-the-class-to-map-the-field-in-the-Mongodb" class="headerlink" title="Note, your fields in c# class should exactly map the fields you have in your collection. For example, if each entry in your mongodb collection has 5 fields including Mongodb id, you must create 5 fields in your class to map those fields.Otherwise, it won’t work as you expected.  Each field can be annotated with BsonElement to tell the driver this is the field in the class to map the field in the Mongodb."></a>Note, your fields in c# class should exactly map the fields you have in your collection. For example, if each entry in your mongodb collection has 5 fields including Mongodb id, you must create 5 fields in your class to map those fields.Otherwise, it won’t work as you expected.  Each field can be annotated with BsonElement to tell the driver this is the field in the class to map the field in the Mongodb.</h3><blockquote>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">Restaurant</span></span><br><span class="line">&#123;</span><br><span class="line">   <span class="comment">//Your mongoId</span></span><br><span class="line">   [<span class="meta">BsonId</span>]</span><br><span class="line">   <span class="keyword">public</span> ObjectId InternalId &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line"></span><br><span class="line">   [<span class="meta">BsonElement(<span class="meta-string">"id"</span>)</span>]</span><br><span class="line">   <span class="keyword">public</span> Int64 Id &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line"></span><br><span class="line">   [<span class="meta">BsonElement(<span class="meta-string">"rating"</span>)</span>]</span><br><span class="line">   <span class="keyword">public</span> <span class="keyword">double</span> Rating &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line"></span><br><span class="line">   [<span class="meta">BsonElement(<span class="meta-string">"name"</span>)</span>]</span><br><span class="line">   <span class="keyword">public</span> <span class="keyword">string</span> Name &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line"></span><br><span class="line">   [<span class="meta">BsonElement(<span class="meta-string">"zone"</span>)</span>]</span><br><span class="line">   <span class="keyword">public</span> List&lt;<span class="keyword">string</span>&gt; Area &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line"></span><br><span class="line">   BsonElement(<span class="string">"link"</span>)]</span><br><span class="line">   <span class="keyword">public</span> <span class="keyword">string</span> Link &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line"></span><br><span class="line">   [<span class="meta">BsonElement(<span class="meta-string">"collection"</span>)</span>]</span><br><span class="line">   <span class="keyword">public</span> List&lt;<span class="keyword">string</span>&gt; Collection &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line"></span><br><span class="line">   [<span class="meta">BsonElement(<span class="meta-string">"restaurant_type"</span>)</span>]</span><br><span class="line">   <span class="keyword">public</span> List&lt;<span class="keyword">string</span>&gt; Type &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line"></span><br><span class="line">   [<span class="meta">BsonElement(<span class="meta-string">"phone_number"</span>)</span>]</span><br><span class="line">   <span class="keyword">public</span> <span class="keyword">string</span> PhoneNumber &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line"></span><br><span class="line">   [<span class="meta">BsonElement(<span class="meta-string">"cuisine_type"</span>)</span>]</span><br><span class="line">   <span class="keyword">public</span> List&lt;<span class="keyword">string</span>&gt; CuisineType &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line"></span><br><span class="line">   [<span class="meta">BsonElement(<span class="meta-string">"address"</span>)</span>]</span><br><span class="line">   <span class="keyword">public</span> <span class="keyword">string</span> Address &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line"></span><br><span class="line">   [<span class="meta">BsonElement(<span class="meta-string">"opening_hours"</span>)</span>]</span><br><span class="line">   <span class="keyword">public</span> Dictionary&lt;<span class="keyword">string</span>,<span class="keyword">string</span>&gt; WorkingHours &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">   [<span class="meta">BsonElement(<span class="meta-string">"food_image_links"</span>)</span>]</span><br><span class="line">   <span class="keyword">public</span> List&lt;<span class="keyword">string</span>&gt; FoodImgs &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line"></span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>
</blockquote>
<h3 id="4-Create-an-interface-to-set-contract-on-behaviour"><a href="#4-Create-an-interface-to-set-contract-on-behaviour" class="headerlink" title="4. Create an interface to set contract on behaviour."></a>4. Create an interface to set contract on behaviour.</h3><blockquote>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title">IRestaurantRepository</span></span><br><span class="line">&#123;</span><br><span class="line">   Task&lt;IEnumerable&lt;Restaurant&gt;&gt; GetAllRestaurants();</span><br><span class="line"></span><br><span class="line">   Task&lt;IEnumerable&lt;Restaurant&gt;&gt; GetByRating(<span class="keyword">double</span> rating);</span><br><span class="line"></span><br><span class="line">   <span class="function">Task&lt;Restaurant&gt; <span class="title">GetById</span>(<span class="params">Int64 id</span>)</span>;</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>
</blockquote>
<h3 id="5-Creating-repository-class-implement-repository-interface-to-retrive-data-from-your-databases-We-use-async-to-get-better-user-experience-and-it-won’t-freeze-the-user-window"><a href="#5-Creating-repository-class-implement-repository-interface-to-retrive-data-from-your-databases-We-use-async-to-get-better-user-experience-and-it-won’t-freeze-the-user-window" class="headerlink" title="5. Creating repository class, implement repository interface, to retrive data from your databases. We use async to get better user experience and it won’t freeze the user window."></a>5. Creating repository class, implement repository interface, to retrive data from your databases. We use async to get better user experience and it won’t freeze the user window.</h3><blockquote>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">RestaurantRepository</span> : <span class="title">IRestaurantRepository</span></span><br><span class="line">&#123;</span><br><span class="line">   <span class="keyword">private</span> <span class="keyword">readonly</span> MongoContext _context = <span class="literal">null</span>;</span><br><span class="line"></span><br><span class="line">   <span class="function"><span class="keyword">public</span> <span class="title">RestaurantRepository</span>(<span class="params">IOptions&lt;Settings&gt; Settings</span>)</span></span><br><span class="line"><span class="function"></span>   &#123;</span><br><span class="line">       _context = <span class="keyword">new</span> MongoContext(Settings);</span><br><span class="line"></span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">   <span class="keyword">public</span> <span class="keyword">async</span> Task&lt;IEnumerable&lt;Restaurant&gt;GetAllRestaurants()</span><br><span class="line">   &#123;</span><br><span class="line">       <span class="keyword">try</span></span><br><span class="line">       &#123;</span><br><span class="line">           <span class="keyword">return</span> <span class="keyword">await</span> _context.Restaurants.Find(_ =<span class="literal">true</span>).ToListAsync();</span><br><span class="line">       &#125;</span><br><span class="line">       <span class="keyword">catch</span> (Exception e)</span><br><span class="line">       &#123;</span><br><span class="line">           Console.WriteLine(e);</span><br><span class="line">           <span class="keyword">throw</span> e;</span><br><span class="line">       &#125;</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">   <span class="keyword">public</span> <span class="keyword">async</span> Task&lt;IEnumerable&lt;Restaurant&gt;GetByRating(<span class="keyword">double</span> rating)</span><br><span class="line">   &#123;</span><br><span class="line">       <span class="keyword">try</span></span><br><span class="line">       &#123;</span><br><span class="line">           <span class="keyword">var</span> restaurants =  <span class="keyword">await</span> _context.Restaurants</span><br><span class="line">               .Find(res =&gt; res.Rating &gt;= rating)</span><br><span class="line">               .ToListAsync();</span><br><span class="line"></span><br><span class="line">           <span class="keyword">return</span> restaurants;</span><br><span class="line">       &#125;</span><br><span class="line">       <span class="keyword">catch</span> (Exception e)</span><br><span class="line">       &#123;</span><br><span class="line">           Console.WriteLine(e);</span><br><span class="line">           <span class="keyword">throw</span> e;</span><br><span class="line">       &#125;</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">   <span class="function"><span class="keyword">public</span> <span class="keyword">async</span> Task&lt;Restaurant&gt; <span class="title">GetById</span>(<span class="params"><span class="keyword">long</span> id</span>)</span></span><br><span class="line"><span class="function"></span>   &#123;</span><br><span class="line">       <span class="keyword">try</span></span><br><span class="line">       &#123;</span><br><span class="line">           <span class="keyword">return</span> <span class="keyword">await</span> _context.Restaurants.Find(res =res.Id == id).FirstOrDefaultAsync();</span><br><span class="line">       &#125;</span><br><span class="line">       <span class="keyword">catch</span> (Exception e)</span><br><span class="line">       &#123;</span><br><span class="line">           Console.WriteLine(e);</span><br><span class="line">           <span class="keyword">throw</span> e;</span><br><span class="line">       &#125;</span><br><span class="line">   &#125;</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>
</blockquote>
<h3 id="6-Build-up-your-Controller"><a href="#6-Build-up-your-Controller" class="headerlink" title="6. Build up your Controller."></a>6. Build up your Controller.</h3><blockquote>
<h4 id="Here-is-just-an-example-of-how-you-could-use-your-repository-class-to-retrieve-your-result-You-may-use-DTO-class-to-map-your-class-for-better-security-concern-which-I-will-discuss-with-you-later"><a href="#Here-is-just-an-example-of-how-you-could-use-your-repository-class-to-retrieve-your-result-You-may-use-DTO-class-to-map-your-class-for-better-security-concern-which-I-will-discuss-with-you-later" class="headerlink" title="Here is just an example of how you could use your repository class to retrieve your result. You may use DTO class to map your class for better security concern, which I will discuss with you later."></a>Here is just an example of how you could use your repository class to retrieve your result. You may use DTO class to map your class for better security concern, which I will discuss with you later.</h4><blockquote>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">[<span class="meta">Produces(<span class="meta-string">"application/json"</span>)</span>]</span><br><span class="line">[<span class="meta">Microsoft.AspNetCore.Mvc.Route(<span class="meta-string">"[Controller]"</span>)</span>]</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">RestaurantsController</span> : <span class="title">Controller</span></span><br><span class="line">&#123;</span><br><span class="line">   <span class="keyword">private</span> <span class="keyword">readonly</span> IRestaurantRepository _restaurantRepository;</span><br><span class="line">   <span class="function"><span class="keyword">public</span> <span class="title">RestaurantsController</span>(<span class="params">IRestaurantRepositorrestaurantRepository, IMapper mapper</span>)</span></span><br><span class="line"><span class="function"></span>   &#123;</span><br><span class="line">       _restaurantRepository = restaurantRepository;</span><br><span class="line">       _mapper = mapper;</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">   [<span class="meta">HttpGet</span>]</span><br><span class="line">   <span class="keyword">public</span> <span class="keyword">async</span> Task&lt;IEnumerable&lt;Restaurant&gt;&gt; Get()</span><br><span class="line">   &#123;</span><br><span class="line">       <span class="keyword">return</span> <span class="keyword">await</span> _restaurantRepository.GetAllRestaurants();</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">   <span class="comment">//api/restaurant/byRating?rating= 1.1</span></span><br><span class="line">   [<span class="meta">HttpGet(<span class="meta-string">"rating/&#123;rating&#125;"</span>)</span>]</span><br><span class="line">   <span class="keyword">public</span> <span class="keyword">async</span> Task&lt;IEnumerable&lt;RestaurantDTO&gt;GetByRating(<span class="keyword">double</span> rating)</span><br><span class="line">   &#123;   </span><br><span class="line">       <span class="keyword">var</span> result = awai_restaurantRepository.GetByRating(rating);</span><br><span class="line">       <span class="keyword">return</span> _mapper.Map&lt;IEnumerable&lt;Restaurant&gt;IEnumerable&lt;RestaurantDTO&gt;&gt;(result);;    </span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>
</blockquote>
</blockquote>
<h3 id="7-Register-your-Mongo-services-to-your-application"><a href="#7-Register-your-Mongo-services-to-your-application" class="headerlink" title="7. Register your Mongo services to your application."></a>7. Register your Mongo services to your application.</h3><blockquote>
<h4 id="This-is-the-final-step-to-setup-your-MongoDb-connection-In-the-Startup-cs-file-Under-ConfigureServices-method"><a href="#This-is-the-final-step-to-setup-your-MongoDb-connection-In-the-Startup-cs-file-Under-ConfigureServices-method" class="headerlink" title="This is the final step to setup your MongoDb connection.  In the Startup.cs file, Under ConfigureServices method"></a>This is the final step to setup your MongoDb connection.  In the Startup.cs file, Under ConfigureServices method</h4><blockquote>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">services.Configure&lt;Settings&gt;(options =&gt;</span><br><span class="line">&#123;</span><br><span class="line">   options.ConnectionString</span><br><span class="line">       Configuration.GetSection(<span class="string">"MongoConneconnectionString"</span>).Value;</span><br><span class="line">   options.Database</span><br><span class="line">       Configuration.GetSection(<span class="string">"MongoConnecatabase"</span>).Value;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">services.AddTransient&lt;IRestaurantReposiRestaurantRepository&gt;(); </span><br></pre></td></tr></table></figure>
</blockquote>
<h4 id="To-observe-the-difference-between-AddTransient-AddScoped-and-AddSingleton-here-is-a-good-explanation-about-the-difference"><a href="#To-observe-the-difference-between-AddTransient-AddScoped-and-AddSingleton-here-is-a-good-explanation-about-the-difference" class="headerlink" title="To observe the difference between AddTransient, AddScoped and AddSingleton, here is a good explanation about the difference."></a>To observe the difference between AddTransient, AddScoped and AddSingleton, <a href="https://stackoverflow.com/questions/38138100/addtransient-addscoped-and-addsingleton-services-differences" target="_blank" rel="noopener">here</a> is a good explanation about the difference.</h4></blockquote>
<h3 id="Now-you-are-good-to-go"><a href="#Now-you-are-good-to-go" class="headerlink" title="Now you are good to go!"></a>Now you are good to go!</h3>
                    
                    <!-- Tags Bottom -->
                    
                        <div class="tags-container-bottom">
                            <i class="fa fa-tag pr3 text-main-color"></i><a class="fw3 ph1 dib" href="/tags/Mongodb/">#Mongodb</a> <a class="fw3 ph1 dib" href="/tags/Net-Core/">#.Net Core</a>
                        </div>
                    

                    <!-- Comments -->
                    



                </div>
                <div class="fl w-100 w-30-l center fw3 lh-copy pl4-ns tl black-50">
                    
                    <hr class="dn-l mw4 black-50 mt5" />
                    
                    <!-- Widget 1: About -->
                    <div class="mt5 mt0-l">
    <article class="dt db-l mw8 mw8-m mw5-ns center ml0-l bg-white mv3">
        <div class="dn dtc-m db-l v-mid tc pr4 pr0-l" style="min-width: 6rem;">
            <img src="/V.jpg" class="mb4-l br-100 h3 w3 h4-l w4-l dib" title="John Doe">
        </div>
        <div class="dtc db-l v-mid lh-copy measure center f6 black-50 tj">
            My name is Junhan Liu and this is my blog
        </div>
    </article>
</div>

                    <hr class="dn-l mw4 black-50 mt5" />
                    
                    <!-- Widget 2: Categories -->
                    
                        <div class="mt5 tc tl-l">
    <h3>Categories</h3>
    
        <p>
            <a href="/categories/C/">C#</a>
        </p>
    
</div>


                        <hr class="dn-l mw4 black-50 mt5" />
                    

                    <!-- Widget 3: Recent Posts -->
                    <div class="mt5 tc tl-l">
    <h3>Recent Posts</h3>
    
        <p>
            <a href="/2020/01/05/Connecting-and-querying-asynchronously-with-mongodb-in-Net-Core-framework/">Connecting and querying asynchronously with mongod</a>
        </p>
    
        <p>
            <a href="/2019/12/25/How-to-connect-your-MySql-running-on-Docker-remotely/">How to connect your MySql running on Docker remote</a>
        </p>
    
        <p>
            <a href="/2019/12/18/How%20to%20build%20M-N%20relationship%20using%20EF%20Core/">How to build M-N relationship using EF Core</a>
        </p>
    
        <p>
            <a href="/2019/12/18/hello-world/">Hello World</a>
        </p>
    
</div>
                </div>
            </div>
        </div>
    </div>
</div>


<!-- Footer -->
<div class="bg-1 ph2 ph5-ns pv5">
        <div class="mv8">
            <div class="center tc">
                
                    <div class="dib mh3">
                        <a class="f3 f2-ns white dim" href="https://twitter.com/?lang=en" target="_blank">
                            <i class="fa fa-twitter"></i>
                        </a>
                    </div>
                
                    <div class="dib mh3">
                        <a class="f3 f2-ns white dim" href="https://www.facebook.com/" target="_blank">
                            <i class="fa fa-facebook"></i>
                        </a>
                    </div>
                
                    <div class="dib mh3">
                        <a class="f3 f2-ns white dim" href="https://dribbble.com/" target="_blank">
                            <i class="fa fa-dribbble"></i>
                        </a>
                    </div>
                
                    <div class="dib mh3">
                        <a class="f3 f2-ns white dim" href="https://github.com/klugjo/hexo-theme-anodyne" target="_blank">
                            <i class="fa fa-github"></i>
                        </a>
                    </div>
                
                    <div class="dib mh3">
                        <a class="f3 f2-ns white dim" href="https://plus.google.com/" target="_blank">
                            <i class="fa fa-google-plus"></i>
                        </a>
                    </div>
                
                    <div class="dib mh3">
                        <a class="f3 f2-ns white dim" href="https://www.behance.net/" target="_blank">
                            <i class="fa fa-behance"></i>
                        </a>
                    </div>
                
                    <div class="dib mh3">
                        <a class="f3 f2-ns white dim" href="https://500px.com/" target="_blank">
                            <i class="fa fa-500px"></i>
                        </a>
                    </div>
                
                    <div class="dib mh3">
                        <a class="f3 f2-ns white dim" href="mailto:test@example.com" target="_blank">
                            <i class="fa fa-envelope"></i>
                        </a>
                    </div>
                
                    <div class="dib mh3">
                        <a class="f3 f2-ns white dim" href="/#" target="_blank">
                            <i class="fa fa-rss"></i>
                        </a>
                    </div>
                
            </div>
            <div class="f6 f5-ns center tc white pt5 fw3">
                @Untitled. All right reserved | Design & Hexo <a class="link dim white" href="http://www.codeblocq.com/" target="_blank" rel="noopener">Jonathan Klughertz</a>
            </div>
        </div>
    </div>

<!-- After Footer -->
<!-- Disqus Comments -->



</body>

</html>